67,78d66
< std::vector<std::string>
< getBufferList(const std::shared_ptr<CompositeInstruction> &program) {
<   std::set<std::string> allBuffers;
<   InstructionIterator it(program);
<   while (it.hasNext()) {
<     auto nextInst = it.next();
<     for (const auto &bufferName : nextInst->getBufferNames()) {
<       allBuffers.emplace(bufferName);
<     }
<   }
<   std::vector<std::string> result(allBuffers.begin(), allBuffers.end());
<   return result;
80d67
< } // namespace
85,90d71
<     const auto buffer_names = getBufferList(program);
<     if (buffer_names.size() > 1) 
<     {
<         return;
<     }
< 
142d122
<                         newInst->setBufferNames({ buffer_names[0] });
152d131
<                         newInst->setBufferNames({ buffer_names[0] });
212,216d190
<     const auto buffer_names = getBufferList(program);
<     if (buffer_names.size() > 1) 
<     {
<         return;
<     }
324d297
<                         newInst->setBufferNames(std::vector<std::string>(newInst->bits().size(), buffer_names[0]));
334d306
<                         newInst->setBufferNames(std::vector<std::string>(newInst->bits().size(), buffer_names[0]));
