22d21
< #include <string>
31,40d29
< #if defined(__linux__) || defined(__APPLE__)
< #include <unistd.h>
< #elif defined(_WIN64) || defined(_WIN32)
< // This is needed because windows.h redefine min()/max() so interferes with
< // std::min/max
< #define NOMINMAX
< #include <windows.h>
< #endif
< 
< 
1274,1290d1262
< 
< 
< size_t get_system_memory_mb() 
< {
<   size_t total_physical_memory = 0;
< #if defined(__linux__) || defined(__APPLE__)
<   size_t pages = (size_t)sysconf(_SC_PHYS_PAGES);
<   size_t page_size = (size_t)sysconf(_SC_PAGE_SIZE);
<   total_physical_memory = pages * page_size;
< #elif defined(_WIN64) || defined(_WIN32)
<   MEMORYSTATUSEX status;
<   status.dwLength = sizeof(status);
<   GlobalMemoryStatusEx(&status);
<   total_physical_memory = status.ullTotalPhys;
< #endif
<   return total_physical_memory >> 20;
< }
