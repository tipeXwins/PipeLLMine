869,874d868
<   }  
<   uint_t min_qubit = qubits[0];
<   uint_t max_qubit = qubits[0];
<   for (uint_t i=qubits[0]; i<qubits.size(); i++) {
<     min_qubit = std::min(min_qubit, qubits[i]);
<     max_qubit = std::max(max_qubit, qubits[i]);
876d869
<   propagate_to_neighbors_internal(min_qubit, max_qubit);
1501,1503d1493
<   propagate_to_neighbors_internal(qubit, qubit);
<   return measurement;
< }
1505d1494
< void MPS::propagate_to_neighbors_internal(uint_t min_qubit, uint_t max_qubit) {
1507c1496
<   for (uint_t i=max_qubit; i<num_qubits_-1; i++) {
---
>   for (uint_t i=qubit; i<num_qubits_-1; i++) {
1514c1503
<   for (int_t i=min_qubit; i>0; i--) {
---
>   for (int_t i=qubit; i>0; i--) {
1518a1508
>   return measurement;
